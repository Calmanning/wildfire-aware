require(["esri/config","esri/WebMap","esri/views/MapView","esri/widgets/Search","esri/widgets/Home","esri/widgets/ScaleBar","esri/widgets/Measurement","esri/Graphic","esri/symbols/SimpleLineSymbol","esri/layers/GraphicsLayer","esri/core/reactiveUtils","esri/geometry/Point","esri/geometry/Circle","esri/layers/support/TileInfo"],((e,t,r,n,i,a,s,o,l,d,c,p,m,u)=>{"use strict";const y=new URL(window.location.href),h=document.querySelector("#sideBar"),g=document.querySelector("#sideBarToggleArrow"),v=document.querySelector("#searchContainer"),b=document.getElementById("sideBarInformation"),f=document.querySelector("#fire-list"),w=document.querySelector("#fire-list-Btn"),P=document.querySelector("#activeFiresDropdown"),x=document.querySelector("#fireSorting"),T=document.getElementsByClassName("item-header"),S=document.getElementsByClassName("item-content"),I=document.getElementsByClassName("fire-item"),L=[];let E=[];const C=document.querySelectorAll(".sortClass");let H={},O={},F={},A={},D={},R={},N={},k={},M={},$={};const q=document.querySelector("#layers"),G=document.querySelector("#layer-List-Container-background"),W=document.querySelector("#layer-list-button"),j=document.querySelector("#fire-points"),_=document.querySelector("#fire-points-legend"),B=document.querySelector("#fire-perimeters"),U=document.querySelector("#fire-perimeter-legend"),V=document.querySelector("#watchesAndWarnings"),z=document.querySelector("#watchesAndWarnings-img-legend"),K=document.querySelector("#satellite-hotspots"),Q=document.querySelector("#SatelliteHotSpot-img-legend"),Y=document.querySelector("#AQI-today"),J=document.querySelector("#aqiToday-img-legend"),X=document.querySelector("#AQI-tomorrow"),Z=document.querySelector("#aqiTomorrow-img-legend"),ee=document.querySelector("#burned-areas"),te=document.querySelector("#burnedAreas-img-legend"),re=document.querySelector("#census-points"),ne=document.querySelector("#population-points-legend"),ie=new t({portalItem:{id:"d4ec5d878d00465cb884a6c610aa5442"},layers:[]}),ae=new r({container:"viewDiv",spatialReference:102100,popup:{popup:null,autoOpenEnabled:!1}}),se=u.create({spatialReference:{wkid:102100},numLODs:32}).lods,oe=new d({graphics:[]});ie.load().then((()=>{ie.basemap.load()})).then((()=>{ae.map=ie,ae.constraints={lods:se,rotationEnabled:!1,snapToZoom:!0},document.querySelector(".loader").classList.remove("is-active")})).catch((e=>{console.log(e)}));const le=new n({view:ae,resultGraphicEnabled:!1,popupEnabled:!1,container:v}),de=new i({view:ae,container:homeContainer});de.goToOverride=()=>(pe(),f.style.display="initial",w.style.display="none",b.style.display="none",x.style.display="initial",P.style.position="sticky",Ie(),Te(),Re(),window.screen.width<=820?ae.goTo({zoom:5,center:[255,39],spatialReference:{wkid:102100}},{duration:1e3}):ae.goTo({zoom:4,center:[245,48],spatialReference:{wkid:102100}},{duration:1e3}));const ce=new a({view:ae}),pe=()=>{window.location.hash=""},me=(ae.when().then((()=>{H=ie.allLayers.find((e=>"Current Incidents"===e.title)),H.outFields=["IRWINID","IncidentName","ModifiedOnDateTime","FireDiscoveryDateTime","FireDiscoveryAge","IncidentTypeCategory","DailyAcres","PercentContained"],O=ie.allLayers.find((e=>"Current Perimeters Fill"===e.title)),O.outFields=["IrwinID","incidentName","GISAcres","FeatureCategory","IncidentTypeCategory","CurrentDateAge","CreateDate","CreateDateAge","dateCurrent"],F=ie.allLayers.find((e=>"Current Perimeters Outline"===e.title)),F.outFields="IrwinID",A=ie.allLayers.find((e=>"Weather Watches and Warnings"===e.title)),D=ie.allLayers.find((e=>"Satellite Hotspots"===e.title)),k=ie.allLayers.find((e=>"Today's AQI Forecast"===e.title)),M=ie.allLayers.find((e=>"Tomorrow's AQI Forecast"===e.title)),R=ie.allLayers.find((e=>"Burned Areas 1984 - 2020 Fill"===e.title)),N=ie.allLayers.find((e=>"Burned Areas Outline"===e.title)),$=ie.allLayers.find((e=>"2020 Census Block Centroids"===e.title))})).then((()=>{ae.ui.add(le,"top-left"),ae.ui.add(de,"top-left"),ae.ui.add(ce,{position:"bottom-right"}),ie.add(oe)})).then((()=>{if(window.location.hash){const e=window.location.hash.substring(3);we({newDefaultLocation:e})}else fe()})).then((()=>{W.addEventListener("click",(e=>{me(e)}))})).catch((e=>{console.error(e)})),e=>{"none"===q.style.display?(q.style.display="inherit",G.style.background="rgb(17, 54, 81)",ue()):(be(),G.style.background="none")}),ue=()=>{"none"===q.style.display?W.innerText="MAP LAYERS":W.innerText="CLOSE"},ye=e=>{"initial"===e.style.display?e.style.display="none":e.style.display="initial"},he=e=>{e.removeAttribute("disabled"),e.parentElement.classList.remove("disable")},ge=e=>{e.setAttribute("disabled",""),e.parentElement.classList.add("disable"),ve(e)},ve=e=>{e.checked=!1,e.parentElement.nextElementSibling.style.display="none"},be=(j.addEventListener("change",(()=>{H.visible=j.checked,ye(_),Le()})),B.addEventListener("change",(()=>{F.visible=B.checked,O.visible=B.checked,ye(U)})),V.addEventListener("change",(()=>{A.visible=V.checked,ye(z),"none"!==J.style.display&&(Y.checked=!1,k.visible=!1,ye(J)),"none"!==Z.style.display&&(X.checked=!1,M.visible=!1,ye(Z)),"none"!==te.style.display&&(ee.checked=!1,R.visible=!1,N.visible=!1,ye(te))})),K.addEventListener("change",(()=>{D.visible=K.checked,ye(Q)})),Y.addEventListener("change",(e=>{k.visible=Y.checked,ye(J),"none"!==Z.style.display&&(X.checked=!1,M.visible=!1,ye(Z)),"none"!==z.style.display&&(V.checked=!1,A.visible=!1,ye(z)),"none"!==te.style.display&&(ee.checked=!1,R.visible=!1,N.visible=!1,ye(te)),!0===J.visible?J.parentElement.style.marginBottom=null:J.parentElement.style.marginBottom=0})),X.addEventListener("change",(()=>{M.visible=X.checked,ye(Z),"none"!==J.style.display&&(Y.checked=!1,k.visible=!1,ye(J)),"none"!==z.style.display&&(V.checked=!1,A.visible=!1,ye(z)),"none"!==te.style.display&&(ee.checked=!1,R.visible=!1,N.visible=!1,ye(te))})),ee.addEventListener("change",(()=>{R.visible=ee.checked,N.visible=ee.checked,ye(te),"none"!==J.style.display&&(Y.checked=!1,k.visible=!1,ye(J)),"none"!==Z.style.display&&(X.checked=!1,M.visible=!1,ye(Z)),"none"!==z.style.display&&(V.checked=!1,A.visible=!1,ye(z))})),re.addEventListener("change",(()=>{$.visible=re.checked,ye(ne)})),()=>{q.style.display="none",ue()}),fe=()=>window.screen.width<=820?ae.goTo({zoom:5,center:[255,39],spatialReference:{wkid:102100}},{duration:1e3}):ae.goTo({zoom:4,center:[245,48],spatialReference:{wkid:102100}},{duration:1e3}),we=async({newDefaultLocation:e})=>{const t=e.split(","),r={x:t[0],y:t[1]},n=new p(r);if(t[3]&&"loc"===t[3])qe({mapPoint:n}),Xe({mapPoint:n}),Je({mapPoint:n}),xe({mapPoint:n});else if(t[3]&&t[3].length>=35){const e=t[3];je({irwinID:e})}else await Ee({mapPoint:n}),setTimeout((()=>{"12"!==t[2]&&(ae.zoom=t[2])}),1e3)},Pe=new o({symbol:{type:"simple-fill",color:[0,0,0,0],outline:new l({color:[255,186,31,1],style:"long-dash",width:2})}}),xe=async({mapPoint:e,fireLocation:t})=>{const r=new m({center:e||t,geodesic:!0,numberOfPoints:200,radius:2,radiusUnit:"miles"});Pe.symbol.outline.style=ae.zoom<=8?"solid":"long-dash",Pe.geometry=r,ae.graphics.add(Pe)},Te=async()=>{ae.graphics.removeAll()},Se=async({fireIconGraphicInfo:e,fireInformation:t})=>{const r=t?t[0].split(","):e.geometry,n=t?t[3].split(" ")[0]:e.attributes.TotalIncidentPersonnel;await Ie();const i=new o({geometry:{type:"point",x:r.x||+r[0],y:r.y||+r[1]},symbol:{type:"simple-marker",size:17,color:[17,54,81,1],outline:{width:2,color:[255,186,31]}}});parseInt(n)>500?i.symbol.size=33:parseInt(n)<500?i.symbol.size=30:parseInt(n)<50&&(i.symbol.size=17),ie.layers.reorder(oe,11),oe.graphics.push(i)},Ie=async()=>{oe.graphics&&oe.graphics.pop()},Le=()=>{oe.graphics.items[0].visible=H.visible},Ee=async({mapPoint:e})=>{if(ae.zoom>10)return;ae.goTo({target:e,zoom:12},{duration:1e3,animate:!0}).catch((e=>{console.error(e)}))},Ce=()=>{I[0].style.marginTop="39px"},He=e=>{if(!e.length)return void(f.innerHTML="");const t=e.map((e=>{if("object"==typeof e){const t={fireName:e[0]?e[0].attributes.IncidentName.toUpperCase():e.attributes.IncidentName.toUpperCase(),fireId:e[0]?e[0].attributes.IrwinID:e.attributes.IrwinID,fireAcres:e[0]?`${e[0].attributes.DailyAcres.toLocaleString()} acres`:`${e.attributes.DailyAcres.toLocaleString()} acres`,firePersonnel:e[0]?e[0].attributes.TotalIncidentPersonnel:e.attributes.TotalIncidentPersonnel,fireLocation:e[0]?[e[0].geometry.x,e[0].geometry.y]:[e.geometry.x,e.geometry.y],fireType:e[0]?e[0].attributes.IncidentTypeCategory:e.attributes.IncidentTypeCategory};return`\n      <div class = "fire-item padding-left-2" style = "margin-bottom: 15px; cursor: pointer;" value="${t.fireLocation}, ${t.fireId}, ${t.fireType}, ${t.firePersonnel}" > \n        <h5 style ="font-weight: bold; margin-bottom: -4px; color: #ffb600; line-height: 21px;" value="${t.fireLocation}, ${t.fireId}, ${t.fireType}, ${t.firePersonnel}">${t.fireName} </h5>\n        \n        <p value="${t.fireLocation}, ${t.fireId}, ${t.fireType}, ${t.firePersonnel}">${C[0].classList.contains("underline")?t.firePersonnel:t.fireAcres}</p>\n        \n      </div>\n      `}return`<p class = "trailer-0 fire-list-date" style = "margin-top: 1rem; cursor: default;">${e.toUpperCase()}</p>`}));f.innerHTML=[...t].join(""),t[0].includes("h5")&&Ce(),We()};c.when((()=>ae?.stationary),(()=>{const e=ae.extent;Ge({extentGeometry:e})})),c.watch((()=>ae?.zoom),(async()=>{if(ae.zoom>=0&&ae.zoom<=9?(Y.attributes.disabled||X.attributes.disabled)&&(he(Y),he(X)):(ge(Y),ge(X),k.visible=Y.checked,M.visible=Y.checked,"intitial"!==J.style.display&&"intitial"!==Z.style.display||ye(J||Z)),ae.zoom>=0&&ae.zoom<=9?he(V):(ge(V),A.visible=V.checked),ae.zoom>=9&&ae.zoom<=11?he(ee):(ge(ee),R.visible=ee.checked,N.visible=ee.checked),ae.zoom>=12&&ae.zoom<=15?he(re):(ge(re),$.visible=re.checked),ae.zoom<=9&&ae.graphics.items.length>0&&oe.graphics.items.length>0){const e=Pe.clone();e.symbol.outline.style="solid",await Te(),ae.graphics.add(e),ae.graphics.items[0].visible=!1}else if(ae.zoom>=10&&ae.graphics.items.length>0&&oe.graphics.items.length>0){const e=Pe.clone();e.symbol.outline.style="long-dash",await Te(),ae.graphics.add(e),ae.graphics.items[0].symbol.outline.style="long-dash",ae.graphics.items[0].visible=!0}else if(ae.zoom<=8&&ae.graphics.items.length>0&&0===oe.graphics.items.length){const e=Pe.clone();e.symbol.outline.style="solid",await Te(),ae.graphics.add(e)}else if(ae.zoom>=9&&ae.graphics.items.length>0&&0===oe.graphics.items.length){const e=Pe.clone();e.symbol.outline.style="long-dash",await Te(),ae.graphics.add(e)}}));const Oe=()=>{window.screen.width>720&&h.style.height&&(h.style.height=null)};window.addEventListener("load",Oe,!1),window.addEventListener("resize",Oe,!1),ae.on("click",(async e=>{const t=e.mapPoint;!1!==await $e({mapPoint:t})&&(await Te(),await Ie(),Fe(e),window.screen.width<=720&&(h.style.height="100%"),g.style.transform="rotate(180deg)")}));const Fe=e=>{let t;ae.hitTest(e,{include:[H,O,F]}).then((r=>{if(r.results.length){t=r.results.filter((e=>e.graphic))[0].graphic;const e=t.attributes;t.sourceLayer.title.includes("Current Incidents"),je({hitTestResponse:e})}else{T[0].innerHTML="",S[0].innerHTML="";const t=e.mapPoint;qe({mapPoint:t}),Xe({mapPoint:t}),Je({mapPoint:t}),xe({mapPoint:t}),Ae({mapPoint:t})}}))},Ae=({mapPoint:e,irwinIdNumber:t})=>(y.hash=`@=${e.longitude.toFixed(3)},${e.latitude.toFixed(3)},${ae.zoom<=8?12:ae.zoom},${t||"loc"}`,window.location.href=y.hash.toString());w.addEventListener("click",(async()=>{De(),await Te(),await Ie(),pe(),ke(),b.style.display="none"}));const De=e=>{"initial"===f.style.display||e&&f.style.display?(f.style.display="none",w.style.display="initial",b.style.display="initial",P.style.position="",Re(),x.style.display="none"):(f.style.display="initial",w.style.display="none",b.style.display="none",P.style.position="sticky",x.style.display="initial",Re())},Re=(document.querySelector("#return-top-Btn").addEventListener("click",(()=>{Re()})),()=>{document.querySelector("#infoBar").scrollTo(0,0)}),Ne=(g.addEventListener("click",(e=>{e.preventDefault(),"100%"===h.style.height?(h.style.height="0",g.style.transform="rotate(0deg)"):(h.style.height="100%",g.style.transform="rotate(180deg)")})),({personnelSorted:e,dateSorted:t,nameSorted:r,acreSorted:n})=>{C.forEach((i=>{i.addEventListener("click",(i=>{!i.target.classList.contains("underline")&&(C.forEach((e=>{e.classList.remove("underline")})),i.target.classList.add("underline")),i.target.innerText.includes("PERSONNEL")?He(e):i.target.innerText.includes("DATE")?He(t):i.target.innerText.includes("NAME")?He(r):i.target.innerText.includes("SIZE")&&He(n)}))}))}),ke=()=>{C.forEach((e=>{e.classList.remove("underline")})),document.querySelector("#fire-personnel").classList.add("underline"),He(E),Ce()},Me=e=>{const t=`<span style="font-size: 24px; font-weight: bold; color: #FFBA1F; margin-right: 5px;"> ${e} </span> <span style="font-size: 20px;">FIRES IN VIEW</span>`;document.getElementById("firesInView").innerHTML=t},$e=async({mapPoint:e})=>new Promise((t=>{const r={where:"1=1",geometry:e,geometryType:"esriGeometryPoint",inSR:4326,spatialRelationship:"intersects",distance:2,units:"esriSRUnit_StatuteMile",outSR:3857,f:"json"};axios.get("https://services.arcgis.com/jIL9msH9OI208GCb/ArcGIS/rest/services/AllHexesFromAgolAsPoints220811a/FeatureServer/22/query",{params:r}).then((e=>{e.data.fields?t(!0):t(!1)}))})),qe=({mapPoint:e})=>{e?De(e):De(),Ee({mapPoint:e}),Ue({mapPoint:e}),Ve({mapPoint:e}),lt()},Ge=({extentGeometry:e})=>{const t={where:"1=1",time:null,geometry:e,geometryType:"esriGeometryEnvelope",spatialRelationship:"intersects",inSR:3857,returnGeometry:!0,returnQueryGeometry:!0,outFields:["IrwinID","IncidentName","POOState","ModifiedOnDateTime","FireDiscoveryDateTime","FireDiscoveryAge","IncidentTypeCategory","CalculatedAcres","DailyAcres","DiscoveryAcres","PercentContained","TotalIncidentPersonnel"].join(","),f:"json"};axios.get("https://services9.arcgis.com/RHVPKKiFTONKtxq3/ArcGIS/rest/services/USA_Wildfires_v1/FeatureServer/0/query",{params:t}).then((e=>{const t=e.data.features;let r=t.map((e=>({fire:e,monthDay:new Date(e.attributes.FireDiscoveryDateTime).toLocaleString("default",{month:"long",day:"numeric"}),sortDate:e.attributes.FireDiscoveryDateTime})));r=r.sort(((e,t)=>t.sortDate-e.sortDate));let n={};r.forEach((e=>{n[e.monthDay]||(n[e.monthDay]=[]),n[e.monthDay].push(e)}));let i=[];Object.keys(n).forEach((e=>{let t=`${e}`;i.push(t),n[e].forEach((e=>{e.fire.attributes.DailyAcres=e.fire.attributes.DailyAcres?+e.fire.attributes.DailyAcres:e.fire.attributes.DiscoveryAcres?e.fire.attributes.DiscoveryAcres:"Unreported",i.push([e.fire])}))})),(({dateSorted:e,wildFires:t})=>{const r=t;L.push(e);let n=[];[...n]=t.map((e=>Object.assign(e,{acreSorting:+e.attributes.DailyAcres?e.attributes.DailyAcres:0})));let i=[...r];i=i.sort(((e,t)=>e.attributes.IncidentName.trim().localeCompare(t.attributes.IncidentName.trim())));let a=[...r];if(a=n.sort(((e,t)=>t.acreSorting-e.acreSorting)),E=[...r],E=r.sort(((e,t)=>t.attributes.TotalIncidentPersonnel-e.attributes.TotalIncidentPersonnel)),E.map((e=>{e.attributes.TotalIncidentPersonnel=e.attributes.TotalIncidentPersonnel?`${e.attributes.TotalIncidentPersonnel.toLocaleString()} personnel`:"Not reported"})),!e.length||!t.length)return He(0),Me(0),void Ne({personnelSorted:E,dateSorted:e,nameSorted:i,acreSorted:a});C.forEach((t=>{t.innerText.includes("PERSONNEL")&&t.classList.contains("underline")?He(E):t.innerText.includes("DATE")&&t.classList.contains("underline")?He(e):t.innerText.includes("NAME")&&t.classList.contains("underline")?He(i):t.innerText.includes("SIZE")&&t.classList.contains("underline")&&He(a)})),Ne({personnelSorted:E,dateSorted:e,nameSorted:i,acreSorted:a})})({dateSorted:i,wildFires:t}),Me(e.data.features.length)})).catch((e=>{console.error(`query Error: ${e}`),Me(0)}))},We=()=>{document.querySelectorAll(".fire-item").forEach((e=>{e.addEventListener("mouseenter",(e=>{const t=e.target.attributes.value.value.split(", ");Se({fireInformation:t})})),e.addEventListener("mouseleave",Ie),e.addEventListener("click",(t=>{e.removeEventListener("mouseleave",Ie);const r=t.target.attributes.value.value.split(", ")[1];je({irwinID:r})}))}))},je=({hitTestResponse:e,irwinID:t})=>{const r=e?e.IrwinID||e.IRWINID.replace(/[{}]/g,""):t,n={where:`IrwinId ='${r}'`,time:null,outFields:["IrwinID","IncidentName","POOState","POOCounty","ModifiedOnDateTime","FireDiscoveryDateTime","FireDiscoveryAge ","IncidentTypeCategory","DailyAcres","TotalIncidentPersonnel","PercentContained"].join(","),returnGeometry:!0,outSR:4326,f:"json"};axios.get("https://services9.arcgis.com/RHVPKKiFTONKtxq3/ArcGIS/rest/services/USA_Wildfires_v1/FeatureServer/0/query",{params:n}).then((t=>{const n=t.data.features[0],i="WF"!==t.data.features[0].attributes.IncidentTypeCategory?"RX"!==t.data.features[0].attributes.IncidentTypeCategory?"INCIDENT COMPLEX":"PERSCRIPTTION BURN":"WILDFIRE",a=new p({x:t.data.features[0].geometry.x.toFixed(3),y:t.data.features[0].geometry.y.toFixed(3)});(({fireData:e})=>{const t=new Date(e.modifiedOnDateTime).toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric"}),r=new Date(e.fireDiscoveryDateTime).toLocaleDateString(void 0,{hour:"numeric",minute:"numeric",month:"long",day:"numeric",year:"numeric"}),n=e.fireDiscovery,i=e.incidentName.toUpperCase(),a=e.county.toUpperCase(),s=e.state.substring(3),o=e.dailyAcres,l=e.personnelAssigned.toLocaleString(),d=e.incidentType;T[0].innerHTML=`\n                          <p class = "trailer-0 sectionHeader">FIRE INFORMATION</p>\n                          <p class="sectionSubHeader">CURRENT AS OF:  ${t.toUpperCase()} </p>`,S[0].setAttribute("style","display: inline"),S[0].innerHTML=`\n          <div style="display: inline-flex; margin-top: -5px;">\n              <img src= ${e.personnelAssigned&&"PERSCRIPTTION BURN"===d?"https://www.arcgis.com/sharing/rest/content/items/4078350792ea4da2b36cab7351909fd7/data":"number"==typeof e.personnelAssigned?"https://esri.maps.arcgis.com/sharing/rest/content/items/b56beb3d45d14b63af0113901dd767f7/data":"string"==typeof e.personnelAssigned?"https://www.arcgis.com/sharing/rest/content/items/6f3a489a81a54494a1b57cb577e92fcb/data":void 0} \n                style="width:64px; height:64px;" \n                viewbox="0 0 32 32" \n                class="svg-icon" \n                type="image/svg+xml"/>\n              <div>\n                <h4 class = "bold trailer-0" style= "line-height: 0px;"><b>${i}</b></h4>\n                <p class = "trailer-0" style = "font-size: 0.875rem;" >${a} COUNTY, ${s}</p>\n                <p class = "trailer-0" style = "font-size: 0.875rem;" >INCIDENT TYPE: ${d}</p>\n                <p class = "trailer-0" style = "font-size: 0.875rem; white-space:nowrap" >START: ${r.toUpperCase()}</p>\n              </div>\n          </div>\n          \n          <div>\n            <div class = "trailer-0 " style= "margin-top: 10px;"> \n              <span style = "vertical-align: 2px; margin: 0 5px 0px 103px"> DAY </span> <h4 class = "bold trailer-0" style = "white-space: nowrap;"> ${window.screen.width>700||n>0?n:"< 24 hours"}</h4>\n            </div>\n            <div class = "trailer-0 " style= "margin-top: 10px;"> \n              <span style = "vertical-align: 2px; margin: 0 5px 0px 45px;"> PERSONNEL </span> <h4 class = "bold trailer-0" style = "white-space: nowrap;"> ${l}</h4>\n            </div>\n            <div class = "trailer-0" style = "margin: 5px auto;">\n              <span style = "vertical-align: text-bottom; margin: 0 5px 0px 5px"> REPORTED ACRES </span> <h4 class = "bold trailer-0"> ${o?o.toLocaleString():"Not reported"}</h4>\n            </div>\n          </div>\n          <div id = 'containment' style = 'display:inline-flex'>\n            <p class = "trailer-0" style="margin-top: 5px;">\n              <span style = "vertical-align: text-bottom; margin: 0 5px 0 23px;">CONTAINMENT</span>\n              <span id = "containment-text"></span>\n            </p>\n            </div>\n          `,tt(e.percentContained)})({fireData:t.data.features[0]?{irwinId:t.data.features[0].attributes.IrwinID,state:t.data.features[0].attributes.POOState,county:t.data.features[0].attributes.POOCounty,incidentName:t.data.features[0].attributes.IncidentName,fireDiscovery:0===t.data.features[0].attributes.FireDiscoveryAge?"Less than 24 hours":t.data.features[0].attributes.FireDiscoveryAge,fireDiscoveryDateTime:t.data.features[0].attributes.FireDiscoveryDateTime,modifiedOnDateTime:t.data.features[0].attributes.ModifiedOnDateTime,incidentType:i,dailyAcres:null===t.data.features[0].attributes.DailyAcres?"Not reported":t.data.features[0].attributes.DailyAcres,personnelAssigned:t.data.features[0].attributes.TotalIncidentPersonnel?t.data.features[0].attributes.TotalIncidentPersonnel:"Not reported",percentContained:null===t.data.features[0].attributes.PercentContained?"Not reported":t.data.features[0].attributes.PercentContained}:{irwinId:e.IrwinID,incidentName:e.IncidentName,fireDiscovery:e.CurrentDateAge,fireDiscoveryDateTime:e.CreateDate,modifiedOnDateTime:e.DateCurrent,incidentType:e.incidentType,personnelAssigned:null===DailyAcres?"Not reported":t.data.features[0].attributes.TotalIncidentPersonnel,percentContained:"Not reported"}}),qe({mapPoint:a}),_e({irwinIdNumber:r,mapPoint:a}),Se({fireIconGraphicInfo:n}),Ae({mapPoint:a,irwinIdNumber:r})})).catch((e=>{console.log(e)}))},_e=async({irwinIdNumber:e,mapPoint:t})=>{const r={where:`irwinID = '{${e}}'`,geometryType:"esriGeometryPoint",spatialRelationship:"intersects",distance:2,units:"esriSRUnit_StatuteMile",inSR:3857,outFields:"*",returnGeometry:!0,returnQueryGeometry:!0,f:"json"};axios.get("https://services9.arcgis.com/RHVPKKiFTONKtxq3/ArcGIS/rest/services/Wildfire_aggregated_v1/FeatureServer/1/query",{params:r}).then((r=>{const n=!!r.data.fields&&r.data.features[0].attributes;if(n){const e=[{data:n.sum_estimated0_14pop?n.sum_estimated0_14pop:0,name:"< 14"},{data:n.sum_estimated15_17pop?n.sum_estimated15_17pop:0,name:"15-17"},{data:n.sum_estimated18to64pop?n.sum_estimated18to64pop:0,name:"18-64"},{data:n.sum_estimated65_79pop?n.sum_estimated65_79pop:0,name:"65-79"},{data:n.sum_estimated80pluspop?n.sum_estimated80pluspop:0,name:"+ 80"}],t=n.sum_estimated80pluspop+n.sum_estimated65_79pop+n.sum_estimated18to64pop+n.sum_estimated15_17pop+n.sum_estimated0_14pop,r={value:parseFloat(100-n.sum_estpopwith0vehicles/n.sum_p0010001*100).toFixed(1)},i={value:parseFloat(100-n.sum_estpopnoenglish/n.sum_p0010001*100).toFixed(1)},a=Math.round(n.sum_weightedmedianhomevalue/n.sum_h0010001),s={TotalHousingUnits:n.sum_h0010001?n.sum_h0010001.toLocaleString():null,MedianValue:n.sum_weightedmedianhomevalue?`$${a.toLocaleString()}`:null},o={totalPopulation:t?t.toLocaleString():0,percentofPopulationInPoverty:n.sum_estpopinpoverty=n.sum_estpopinpoverty?`${parseFloat(n.sum_estpopinpoverty/t*100).toFixed(0)}%`:"0%",percentofPopulationWithDisability:n.sum_estpopwithdisability=n.sum_estpopwithdisability?`${parseFloat(n.sum_estpopwithdisability/t*100).toFixed(0)}%`:"0%"},l={PctBarren:n.PctBarren,PctCropland:n.PctCropland,PctDevelop:n.PctDevelop,PctForest:n.PctForest,PctGrass:n.PctGrass,PctShrub:n.PctShrub,PctSnowIce:n.PctSnowIce,PctWater:n.PctWater,PctWetlands:n.PctWetlands};n.CritHab=[...new Set(n.CritHab.split(", "))].join(", "),n.OwnersPadus&&(n.OwnersPadus=n.OwnersPadus.split(", ").filter((e=>!e.includes(void 0)&&!1==!e)).reduce(((e,t)=>(e[t]?e[t]++:e[t]=1,e)),{})),n.OwnersPadus[Object.keys(n.OwnersPadus)[0]]?n.OwnersPadus=Object.keys(n.OwnersPadus).join(", ").split(", "):n.OwnersPadus=null;try{n.ForestTypeGroup=n.ForestTypeGroup.replace(/'/g,'"');const e=JSON.parse(n.ForestTypeGroup);n.ForestTypeGroup=e,n.ForestTypeGroup=e[Object.keys(e)[0]]?n.ForestTypeGroup=Object.keys(e):n.ForestTypeGroup=null}catch(e){console.log(e)}const d={Hex_Count:n.Hex_Count,L3EcoReg:n.L3EcoReg?n.L3EcoReg:"No information",LandForm:n.LandForm?n.LandForm:"No information",RichClass:n.RichClass?n.RichClass:null,CritHab:n.CritHab?n.CritHab:null,OwnersPadus:n.OwnersPadus?n.OwnersPadus:null,ForestTypeGroup:n.ForestTypeGroup?n.ForestTypeGroup:null,SumCarbon:n.SumCarbon?Math.round(n.SumCarbon):null};try{n.WHPClass=n.WHPClass.replace(/'/g,'"');const e=JSON.parse(n.WHPClass);e["Very High"]=e["Very High"]/n.Hex_Count||0,e.High=e.High/n.Hex_Count||0,e.Moderate=e.Moderate/n.Hex_Count||0,e.Low=e.Low/n.Hex_Count||0,e["Very Low"]=e["Very Low"]/n.Hex_Count||0,at({consolidatedWHPClass:e})}catch(e){console.error(e)}rt(e),nt(i),it(r),pt({perimeterPopulation:o}),mt({perimeterHousingData:s}),Ze({perimeterLandCover:l}),ut({perimeterEcology:d})}else Be({irwinIdNumber:e,mapPoint:t})}))},Be=({irwinIdNumber:e,mapPoint:t})=>{xe({mapPoint:t}),Xe({mapPoint:t}),Je({mapPoint:t})},Ue=({mapPoint:e,fireInformation:t})=>{const r={where:"1=1",geometry:t?`${t[0]}`:`${e.longitude}, ${e.latitude}`,geometryType:"esriGeometryPoint",inSR:4326,spatialRelationship:"intersects",outFields:"dm",returnQueryGeometry:!0,f:"json"};axios.get("https://services9.arcgis.com/RHVPKKiFTONKtxq3/ArcGIS/rest/services/US_Drought_Intensity_v1/FeatureServer/3/query",{params:r}).then((e=>{const t=e.data.features[0]?e.data.features[0].attributes.dm:"Drought conditions not reported";ot((e=>0===e?"Abnormally dry":1===e?"Moderate":2===e?"Severe":3===e?"Extreme":4===e?" Exceptional":"Not present"===e?"None present":void 0)(t))}))},Ve=async({mapPoint:e,fireInformation:t})=>{const r=await ze({mapPoint:e,fireInformation:t}),n=await Ke({mapPoint:e,fireInformation:t}),i=await Qe({mapPoint:e,fireInformation:t}),a=await Ye({mapPoint:e,fireInformation:t});dt({temp:r,wind:n,airQualityToday:i,airQualityTomorrow:a})},ze=async({mapPoint:e,fireInformation:t})=>new Promise((r=>{const n={where:"1=1",geometry:t?`${t[0]}`:`${e.longitude}, ${e.latitude}`,geometryType:"esriGeometryPoint",inSR:4326,spatialRelationship:"intersects",outFields:["period","temp"].join(","),returnQueryGeometry:!0,f:"json"};axios.get("https://services9.arcgis.com/RHVPKKiFTONKtxq3/ArcGIS/rest/services/NDFD_DailyTemperature_v1/FeatureServer/1/query",{params:n}).then((e=>{if(e.data.fields){const t=e.data.features.sort(((e,t)=>{e.attributes.Period,t.attributes.Period})),n={todayF:`${t[2].attributes.Temp}&deg F`,tomorrowF:`${t[1].attributes.Temp}&deg F`,todayC:`${Math.round(5*(t[0].attributes.Temp-32)/9)}&deg C`,tomorrowC:`${Math.round(5*(t[1].attributes.Temp-32)/9)}&deg C`,renderWeather:!0};r(n)}else{r({todayF:"No data",tomorrowF:"No data",todayC:"No data",tomorrowC:"No data",renderWeather:!1})}})).catch((e=>{console.error(e)}))})),Ke=async({mapPoint:e,fireInformation:t})=>new Promise((r=>{const n={where:"1=1",geometry:t?`${t[0]}`:e,geometryType:"esriGeometryPoint",inSR:4326,outFields:["fromdate","todate","force","label"].join(","),returnQueryGeometry:!0,f:"json"};axios.get("https://services9.arcgis.com/RHVPKKiFTONKtxq3/ArcGIS/rest/services/NDFD_WindSpeed_v1/FeatureServer/0/query",{params:n}).then((e=>{const t=e.data.features.length?e.data.features.sort(((e,t)=>e.attributes.fromdate-t.attributes.fromdate)):null,n=[{mph:"< 1mph",kph:"< 1km/h"},{mph:"1-3 mph",kph:"1-5 km/h"},{mph:"4-7 mph",kph:"6-11 km/h"},{mph:"8-12 mph",kph:"12-19 km/h"},{mph:"13-17 mph",kph:"20-28 km/h"},{mph:"18-24 mph",kph:"29-38 km/h"},{mph:"25-30 mph",kph:"39-49 km/h"},{mph:"31-38 mph",kph:"50-61 km/h"},{mph:"39-46 mph",kph:"62-74 km/h"},{mph:"47-54 mph",kph:"75-88 km/h"},{mph:"55-63 mph",kph:"89-102 km/h"},{mph:"64-72 mph",kph:"103-117 km/h"},{mph:"72-82 mph",kph:"118-132 km/h"},{mph:"83-92 mph",kph:"133-148 km/h"},{mph:"93-103 mph",kph:"149-165 km/h"},{mph:"104-114 mph",kph:"166-183 km/h"},{mph:"115-125 mph",kph:"184-200 km/h"},{mph:"No data",kph:"No data"}],i=t?{today:n[t[0].attributes.force],tomorrow:n[t[8].attributes.force]}:{today:n[17],tomorrow:n[17]};r(i)})).catch((e=>{console.error(e)}))})),Qe=({mapPoint:e,fireInformation:t})=>new Promise((r=>{const n={where:"1=1",geometry:t?`${t[0]}`:e,geometryType:"esriGeometryPoint",inSR:4326,outFields:"gridcode",returnQueryGeometry:!0,f:"json"};axios.get("https://services.arcgis.com/cJ9YHowT8TU7DUyn/ArcGIS/rest/services/AirNowAQIForecast/FeatureServer/0/query",{params:n}).then((e=>{const t=e.data.features[0]?e.data.features[0].attributes.gridcode:"No data";r((e=>1===e?"Good":2===e?"Moderate":3===e?"Unhealthy for sensitive groups":4===e?"Unhealthy":5===e?"Very unhealthy":6===e?"Hazardous":"No data")(t))})).catch((e=>{console.error(e)}))})),Ye=({mapPoint:e,fireInformation:t})=>new Promise((r=>{const n={where:"1=1",geometry:t?`${t[0]}`:e,geometryType:"esriGeometryPoint",inSR:4326,outFields:"gridcode",returnQueryGeometry:!0,f:"json"};axios.get("https://services.arcgis.com/cJ9YHowT8TU7DUyn/ArcGIS/rest/services/AirNowAQIForecast/FeatureServer/1/query",{params:n}).then((e=>{const t=e.data.features[0]?e.data.features[0].attributes.gridcode:"No data";r((e=>1===e?"Good":2===e?"Moderate":3===e?"Unhealthy for sensitive groups":4===e?"Unhealthy":5===e?"Very unhealthy":6===e?"Hazardous":"No data")(t))})).catch((e=>{console.error(e)}))})),Je=({mapPoint:e,fireInformation:t})=>{const r={where:"1=1",geometry:t?`${t[0]}`:e,geometryType:"esriGeometryPoint",spatialRelationship:"intersects",distance:2,units:"esriSRUnit_StatuteMile",inSR:4326,outFields:["P0010001","Estimated0_14Pop","Estimated15_17Pop","Estimated18to64Pop","Estimated65_79Pop","Estimated80PlusPop","EstPopWithDisability","EstPopinPoverty","EstPopNoEnglish","EstPopWith0Vehicles","H0010001","WeightedMedianHomeValue"].join(","),returnGeometry:!0,returnQueryGeometry:!0,f:"json"};axios.get("https://services.arcgis.com/jIL9msH9OI208GCb/ArcGIS/rest/services/Populated_Block_Centroids_2020_v3/FeatureServer/1/query",{params:r}).then((e=>{if(e.data.features){const t=e.data.features.reduce(((e,t)=>(Object.keys(t.attributes).forEach((r=>{e[r]=(e[r]||0)+t.attributes[r]})),e)),{}),r=[{data:t.Estimated0_14Pop,name:"< 14"},{data:t.Estimated15_17Pop,name:"15-17"},{data:t.Estimated18to64Pop,name:"18-64"},{data:t.Estimated65_79Pop,name:"65-79"},{data:t.Estimated80PlusPop,name:"+ 80"}],n=t.Estimated80PlusPop+t.Estimated65_79Pop+t.Estimated18to64Pop+t.Estimated15_17Pop+t.Estimated0_14Pop,i={value:parseFloat(100-t.EstPopNoEnglish/n*100).toFixed(1)},a={value:parseFloat(100-t.EstPopWith0Vehicles/n*100).toFixed(1)},s=Math.round(t.WeightedMedianHomeValue/t.H0010001),o={TotalHousingUnits:t.H0010001?t.H0010001.toLocaleString():null,MedianValue:t.WeightedMedianHomeValue?`$${s.toLocaleString()}`:null},l={totalPopulation:n?n.toLocaleString():0,percentofPopulationInPoverty:t.EstPopinPoverty?`${parseFloat(t.EstPopinPoverty/n*100).toFixed(0)}%`:"0%",percentofPopulationWithDisability:t.EstPopWithDisability?`${parseFloat(t.EstPopWithDisability/n*100).toFixed(0)}%`:"0%"};rt(r),nt(i),it(a),pt({totalRadiusPopulation:l}),mt({radiusHousingData:o})}else{}}))},Xe=({mapPoint:e,fireInformation:t})=>{const r={where:"1=1",geometry:t?`${t[0]}`:e,geometryType:"esriGeometryPoint",inSR:4326,spatialRelationship:"intersects",distance:2,units:"esriSRUnit_StatuteMile",outFields:["L3EcoReg","LandForm","CritHab","OwnersPadus","RichClass","WHPClass","PctWater","PctSnowIce","PctDevelop","PctBarren","PctForest","PctShrub","PctGrass","PctCropland","PctWetlands","SumCarbon","ForestTypeGroup  "].join(","),returnGeometry:!0,returnQueryGeometry:!0,outSR:3857,f:"json"};axios.get("https://services.arcgis.com/jIL9msH9OI208GCb/ArcGIS/rest/services/AllHexesFromAgolAsPoints220823a/FeatureServer/0/query",{params:r}).then((e=>{const t=e.data.features;if(e.data.fields){const e=t.reduce(((e,t)=>(Object.keys(t.attributes).forEach((r=>{"string"!=typeof t.attributes[r]&&"object"!=typeof t.attributes[r]||(e[r]=e[r]+", "||""+t.attributes[r]),e[r]=(e[r]||0)+t.attributes[r]})),e)),{});e.CritHab&&(e.CritHab=e.CritHab.split(", ").filter((e=>!e.includes(void 0)&&!1==!e)).reduce(((e,t)=>(e[t]?e[t]++:e[t]=1,e)),{})),e.CritHab[Object.keys(e.CritHab)]?e.CritHab=Object.keys(e.CritHab).join(", "):e.CritHab=null,e.L3EcoReg&&(e.L3EcoReg=e.L3EcoReg.split(", ").filter((e=>!e.includes(void 0))).reduce(((e,t)=>(e[t]?e[t]++:e[t]=1,e)),{})),e.L3EcoReg[Object.keys(e.L3EcoReg)[0]]?e.L3EcoReg=Object.entries(e.L3EcoReg).sort(((e,t)=>t[0].localeCompare(e[0]))).sort(((e,t)=>t[1]-e[1]))[0][0]:e.L3EcoReg=null,e.LandForm&&(e.LandForm=e.LandForm.split(", ").filter((e=>!e.includes(void 0))).reduce(((e,t)=>(e[t]?e[t]++:e[t]=1,e)),{})),e.LandForm[Object.keys(e.LandForm)[0]]?e.LandForm=Object.entries(e.LandForm).sort(((e,t)=>t[0].localeCompare(e[0]))).sort(((e,t)=>t[1]-e[1]))[0][0]:e.LandForm=null,e.ForestTypeGroup&&(e.ForestTypeGroup=e.ForestTypeGroup.split(",").filter((e=>!e.includes(void 0)&&!e.includes(null))).reduce(((e,t)=>(e[t]?e[t]++:e[t]=1,e)),{})),e.ForestTypeGroup[Object.keys(e.ForestTypeGroup)[0]]?e.ForestTypeGroup=Object.entries(e.ForestTypeGroup).sort(((e,t)=>t[0].localeCompare(e[0]))).sort(((e,t)=>t[1]-e[1])).map((e=>e[0])):e.ForestTypeGroup=null,e.OwnersPadus&&(e.OwnersPadus=e.OwnersPadus.split(", ").filter((e=>!e.includes(void 0)&&!1==!e)).reduce(((e,t)=>(e[t]?e[t]++:e[t]=1,e)),{})),e.OwnersPadus[Object.keys(e.OwnersPadus)[0]]?e.OwnersPadus=Object.keys(e.OwnersPadus).join(", ").split(", "):e.OwnersPadus=null,e.RichClass&&(e.RichClass=e.RichClass.split(", ").filter((e=>!e.includes(void 0)&&!e.includes(null))).reduce(((e,t)=>(e[t]?e[t]++:e[t]=1,e)),{})),e.RichClass[Object.keys(e.RichClass)[0]]?e.RichClass=Object.entries(e.RichClass).sort(((e,t)=>t[0].localeCompare(e[0]))).sort(((e,t)=>t[1]-e[1]))[0][0]:e.RichClass=null,e.SumCarbon=null!==e.SumCarbon?Math.round(e.SumCarbon):0,e.WHPClass&&(e.WHPClass=e.WHPClass.split(", ").filter((e=>!e.includes(void 0))).reduce(((e,t)=>(e[t]?e[t]++:e[t]=1,e)),{})),e.PctBarren=e.PctBarren/t.length,e.PctCropland=e.PctCropland/t.length,e.PctDevelop=e.PctDevelop/t.length,e.PctForest=e.PctForest/t.length,e.PctGrass=e.PctGrass/t.length,e.PctShrub=e.PctShrub/t.length,e.PctSnowIce=e.PctSnowIce/t.length,e.PctWater=e.PctWater/t.length,e.PctWetlands=e.PctWetlands/t.length,e.WHPClass&&(e.WHPClass["Very High"]=e.WHPClass["Very High"]/t.length||0,e.WHPClass.High=e.WHPClass.High/t.length||0,e.WHPClass.Moderate=e.WHPClass.Moderate/t.length||0,e.WHPClass.Low=e.WHPClass.Low/t.length||0,e.WHPClass["Very Low"]=e.WHPClass["Very Low"]/t.length||0),e.Hex_Count=t.length,at({aggregateEcoObj:e}),Ze({aggregateEcoObj:e}),ut({aggregateEcoObj:e})}else{const e={Hex_Count:null,CritHab:null,L3EcoReg:null,LandForm:null,OwnersPadus:null,RichClass:null,PctBarren:0,PctCropland:0,PctDevelop:0,PctForest:0,PctGrass:0,PctShrub:0,PctSnowIce:0,PctWater:0,PctWetlands:0,WHPClass:{"Very High":0,High:0,Moderate:0,Low:0,"Very Low":0}};ut({aggregateEcoObj:e}),Ze({aggregateEcoObj:e}),at({aggregateEcoObj:e})}}))},Ze=({aggregateEcoObj:e,perimeterLandCover:t})=>{const r=[{name:"Forest",percent:e?e.PctForest:t.PctForest,fill:"#005948"},{name:"Barren",percent:e?e.PctBarren:t.PctBarren,fill:"#6E726B"},{name:"Cropland",percent:e?e.PctCropland:t.PctCropland,fill:"#D3AA5F"},{name:"Developed",percent:e?e.PctDevelop:t.PctDevelop,fill:"#993131"},{name:"Grassland",percent:e?e.PctGrass:t.PctGrass,fill:"#918652"},{name:"Scrubland",percent:e?e.PctShrub:t.PctShrub,fill:"#4F482A"},{name:"Snow / Ice",percent:e?e.PctSnowIce:t.PctSnowIce,fill:"#EDEDEB"},{name:"Water",percent:e?e.PctWater:t.PctWater,fill:"#054F8C"},{name:"Wetlands",percent:e?e.PctWetlands:t.PctWetlands,fill:"#028B9C"}];let n=0;r.map((e=>{e.percent=Math.round(e.percent),e.percent<10&&(n+=e.percent,e.percent=0)}));const i={name:"Other",percent:parseFloat(n.toFixed(0)),fill:"#D9C7AE"};r.push(i),et(r)},et=e=>{d3.select("#landcover-graph").remove();const t=e.filter((e=>e.percent));if(0===t.length)return;d3.scaleOrdinal().domain(t).range(["#005948","#6E726B","#D3AA5F","#993131","#918652","#4F482A","#EDEDEB","#028B9C","#054F8C","#D9C7AE"]),d3.select("#landcover-chart").append("div").attr("id","landcover-graph").append("div").style("position","relative").append("svg").attr("height",200).attr("width",320).style("display","block").style("margin","20px auto").attr("id","landcover-svg"),d3.select("#landcover-graph div").insert("div","svg").style("position","absolute").style("top","13%").style("left","28%").style("width","150px").style("height","150px").style("border-radius","50%").style("background-color","rgb(03, 34, 53)").style("z-index",-1);const r=d3.select("#landcover-svg"),n=r.attr("width"),i=r.attr("height"),a=Math.min(n,i)/2,s=r.append("g").attr("transform",`translate(${n/2}, ${i/2})`),o=r.append("g").attr("transform",`translate(${n/2}, ${i/2})`),l=d3.pie().value((e=>e.percent)),d=d3.arc().outerRadius(1*a).innerRadius(.7*a);s.selectAll("arc").data(l(t)).enter().append("path").attr("d",d).attr("fill",(e=>e.data.fill)).on("mouseover",((e,t,r)=>{o.append("text").attr("dy","1em").attr("text-anchor","middle").attr("class","percentage").text(`${t.value}%`),o.append("text").attr("text-anchor","middle").attr("class","landcover").text(`${t.data.name}`)})).on("mouseout",(()=>{o.select(".percentage").remove(),o.select(".landcover").remove()}))},tt=e=>{if(d3.select("#containment-bar").remove(),"Not reported"===e)document.getElementById("containment-text").innerHTML=`<h4 class = "bold trailer-0">${e}</h4>`;else{const t=[100.01,e],r=d3.scaleOrdinal().domain(t).range(["#032235","#FFBA1F"]),n=(d3.select("#containment").append("div").attr("id","svgContainer").attr("width",100).attr("height",100),185),i=d3.select("#svgContainer").append("svg").attr("class","bar").attr("id","containment-bar").style("margin","6px 5px 0").attr("width","100%").attr("height","85%").attr("viewBox","0 0 181 40").append("g").attr("transform","translate( 0, -1.5 )"),a=d3.scaleLinear().domain([0,d3.max(t)]).range([0,n-30]);i.selectAll("rect").data(t).enter().append("rect").attr("width",a).attr("height",20).attr("fill",(e=>r(e))).attr("dy","0.1"),i.append("text").attr("dy","2em").attr("dx","1.5em").attr("x",e*((n-35)/100)).attr("text-anchor","end").attr("fill","#ffb600").style("font-size","1.3rem").style("font-weight","bold").text(`${e}%`)}},rt=e=>{console.log(e);const t=e.reduce(((e,t)=>e+t.data),0),r=135;if(d3.select("#population-graph").remove(),document.querySelector("#population-graph-data-control").innerText="",!t)return void(document.querySelector("#population-graph-label").innerHTML="");d3.select("#population-breakdown").append("div","div").attr("id","population-graph").style("width","100%").style("height","100%").append("svg").attr("id","population-svg");const n=d3.select("#population-svg").attr("height","100%").attr("width","100%").attr("viewBox","0 -28 220 188").attr("preserveAspectRatio","xMidYMax").append("g").attr("transform","translate( 0, 0 )"),i=n.append("g"),a=d3.scaleBand().domain(e.map(((e,t)=>e.name))).range([0,220]).padding(.2),s=d3.scaleLinear().domain([0,d3.max(e,(e=>e.data))]).range([r,0]),o=d3.axisBottom(a);d3.axisLeft(s);i.call(o).attr("transform","translate(0, 135)"),n.selectAll(".bar").data(e).enter().append("rect").attr("class","rect-bar").attr("x",((e,t)=>a(e.name,t))).attr("y",(e=>0===e.data?s(.1):s(e.data))).attr("width",a.bandwidth()).attr("height",(e=>0===e.data?r-s(.1):r-s(e.data))).attr("fill","#0285a8").on("mouseover",((e,t)=>{n.append("text").attr("class","pop").attr("x",a(t.name)).attr("y",0===t.data?s(.1):s(t.data)).attr("dy","-0.5em").attr("dx",""+(t.data<10?"0.7em":"0.25em")).attr("transform",`translate(${t.data>999?-6:0}, 0)`).attr("fill","#ffb600").style("font-weight","bold").text(t.data.toLocaleString())})).on("mouseout",(()=>{n.select(".pop").remove()})),document.querySelector("#population-graph-spacer").innerHTML="",document.querySelector("#population-graph-label").innerHTML="",document.querySelector("#population-graph-spacer").setAttribute("style","width: 25%;"),document.querySelector("#population-graph-label").setAttribute("style","text-align: center; font-size: 0.875rem; margin: 0 auto; width: 75%;"),document.querySelector("#population-graph-label").innerHTML="AGE IN YEARS"},nt=e=>{if(d3.select("#english-percent-bar").remove(),d3.select("#english-pop-header","text").remove(),"NaN"===e.value)return;d3.select("#english-pop-percentage").insert("div","div").attr("id","english-percent-bar").attr("width","100%").attr("height","100%").append("svg").attr("id","english-speaking-svg");const t=[100.01,e.value],r="100.0"===t[1]?"100%":`${t[1]}%`,n=d3.scaleOrdinal().domain(t).range(["#032235","#0285a8"]),i=d3.select("#english-speaking-svg").attr("class","bar").attr("width","100%").attr("height","100%").attr("viewBox","0 0 350 65").attr("preserveAspectRatio","none"),a=i.append("g").attr("transform","translate(175, 27.5)"),s=d3.scaleLinear().domain([0,d3.max(t)]).range([0,350]);i.selectAll("rect").data(t).enter().append("rect").attr("width",s).attr("height",30.01).attr("fill",(e=>n(e))),i.append("text").attr("dy","1.4em").attr("dx","1.5em").attr("x",175).attr("text-anchor","end").style("fill",""+(r.length>6?"#07698C":"white")).style("font-weight","bold").text(r),a.insert("text").attr("id","english-pop-header").attr("dy","1.7em").attr("text-anchor","middle").text("SPEAKS ENGLISH").attr("fill","#efefef")},it=e=>{if(d3.select("#vehicle-percent-bar").remove(),d3.select("#vehicle-pop-header").remove(),"NaN"===e.value)return;d3.select("#vehicle-pop-percentage").insert("div","div").attr("id","vehicle-percent-bar").attr("width","100%").attr("height","100%").append("svg").attr("id","vehicle-svg");const t=[100.01,e.value],r="100.0"===t[1]?"100%":`${t[1]}%`,n=d3.scaleOrdinal().domain(t).range(["#032235","#0285a8"]),i=d3.select("#vehicle-svg").attr("class","bar").attr("width","100%").attr("height","100%").attr("viewBox","0 0 350 55").attr("preserveAspectRatio","none"),a=i.append("g").attr("transform","translate(175, 27.5)"),s=d3.scaleLinear().domain([0,d3.max(t)]).range([0,350]);i.selectAll("rect").data(t).enter().append("rect").attr("width",s).attr("height",30.01).attr("fill",(e=>n(e))),i.append("text").attr("dy","1.4em").attr("dx","1.5em").attr("x",175).attr("text-anchor","end").style("fill",""+(r.length>6?"#07698C":"white")).style("font-weight","bold").text(r),a.insert("text").attr("id","vehicle-pop-header").attr("dy","1.7em").attr("text-anchor","middle").text("HAS VEHICLE").attr("fill","#efefef")},at=({aggregateEcoObj:e,consolidatedWHPClass:t})=>{const r=[{name:"VERY HIGH",value:e?e.WHPClass["Very High"]:t["Very High"]},{name:"HIGH",value:e?e.WHPClass.High:t.High},{name:"MODERATE",value:e?e.WHPClass.Moderate:t.Moderate},{name:"LOW",value:e?e.WHPClass.Low:t.Low},{name:"VERY LOW",value:e?e.WHPClass["Very Low"]:t["Very Low"]}];st({wildfireRiskData:r})},st=({wildfireRiskData:e})=>{const t=e;if(d3.select("#wildfire-risk-graph").remove(),document.querySelector("#wildfire-risk-data-control").innerText="",0===t.reduce(((e,t)=>e+t.value),0))return document.querySelector("#wildfire-risk-data-control").innerText="",void(document.querySelector("#wildfire-risk-header").innerText="");const r=15,n=45,i=170-r-10;d3.select("#wildfire-risk").append("div","div").attr("id","wildfire-risk-graph").attr("width","100%").attr("height","100%").append("svg").attr("id","wildfire-risk-graph-svg").attr("transform","translate(0, 0)");const a=d3.scaleOrdinal().domain(t).range(["#993131","#B6673E","#D3AA5F","#C1B999","#707767"]),s=d3.select("#wildfire-risk-graph-svg").attr("height","100%").attr("width","100%").attr("viewBox","-45 0 340 170").attr("preserveAspectRatio","none").style("overflow","visible"),o=s.append("g").attr("transform",`translate(${n}, ${r})`),l=d3.scaleLinear().domain([0,d3.max(t,(e=>e.value))]).range([0,340]),d=d3.scaleBand().domain(t.map((e=>e.name))).range([0,i]).padding(-.1),c=d3.axisBottom(l),p=d3.axisLeft(d);o.append("g").call(p).selectAll(".domain, .tick line").remove();o.append("g").call(c).attr("transform","translate(0, 170)").selectAll(".domain, .tick").remove(),s.selectAll(".bar").data(t).enter().append("g").attr("transform",`translate(${n}, 22)`).append("rect").attr("class","fire-rect-bar").attr("y",((e,t)=>d(e.name,t))).attr("width",(e=>e.value>0?200*e.value:4)).attr("height","20px").attr("fill",(e=>a(e.name))),s.selectAll(".bar").data(t).enter().append("text").attr("transform",`translate(${n+10}, 38)`).attr("class","riskPercent").attr("x",(e=>195*e.value)).attr("y",((e,t)=>d(e.name,t))).attr("fill","#EFEFEF").style("font-weight","bold").text((e=>e.value>0?`${Math.round(100*e.value)}%`:"0%"))},ot=e=>{document.querySelector("#drought-condition").innerHTML=`\n      <div style = "display: flex;">\n          <div style = "width: max-content;">\n            <p style="margin-bottom: 0">DROUGHT STATUS</p>\n          </div>\n          <div style = "margin: -6px 0 0 10px;">\n            <h4 class = "bold trailer-0"> \n            ${e}\n            </h4>\n          </div>\n        </div>`;e||(document.querySelector("#drought-condition").innerHTML="")},lt=()=>{document.querySelector("#temp-wind-aq").innerHTML='\n      <div class="loader is-active padding-leader-3 padding-trailer-3">\n        <div class="loader-bars"></div>\n        <div class="loader-text">Loading...</div>\n      </div>'},dt=({temp:e,wind:t,airQualityToday:r,airQualityTomorrow:n})=>{const i=r,a=n;(async e=>{e.renderWeather?document.querySelector("#temp-wind-aq").innerHTML=`\n          <div style = "\n                    display: grid; \n                    grid-template-columns: repeat(3, minmax(0, 1fr));\n                    grid-template-rows: auto auto auto;\n                    gap: 0px;\n                    margin: auto;">\n                        <div class="item-1" style = "margin: 15px 0 10px -5px; text-align: center;">\n                          <span class="unit-conversion underline" style = "cursor: pointer; display: block; margin: -5px 0 -15px 0;">&degF MPH</span>\n                          </br>\n                          <span class="unit-conversion" style = "cursor: pointer;">&degC KM/H</span>\n                        </div>\n                        <div class="item-2" style = "padding: 25px 0; text-align: center;">\n                          <span>TODAY</span>\n                        </div>\n                        <div class="item-3" style = "padding: 25px 0; text-align: center;">\n                          <span>TOMORROW</span>\n                        </div>\n                        <div class="item-4">\n                          <p style = "margin: 1rem; text-align: center;">TEMP</p>\n                        </div>\n                        <div id = "today-temp" \n                        style = "border: 1px solid; border-style: none solid none solid;">\n                          <p style="margin: 1rem; text-align: center;">${e.todayF}</p>\n                        </div>\n                        <div id = "tomorrow-temp">\n                           <p style="margin: 1rem; text-align: center;">${e.tomorrowF}</p>\n                        </div>\n                        <div class="item-7" \n                        style = "border: 1px solid; border-style: solid none solid none;">\n                          <p style = "margin: 1rem; text-align: center;">WIND</p>\n                        </div>\n                        <div id = "today-wind" \n                        style = "border: 1px solid;">\n                          <p style="margin: 1rem; text-align: center;"> ${t.today.mph} </p>\n                        </div>\n                        <div id= "tomorrow-wind" \n                        style = "border: 1px solid; border-style: solid none solid none;">\n                        <p style="margin: 1rem; text-align: center;"> ${t.today.mph} </p></div>\n                        <div style = "display: flex;">\n                          <p  style = "margin-top: 20px; text-align: center; line-height: 20px;">AIR QUALITY INDEX</p>\n                        </div>\n                        <div id = "aqi-current" \n                        style = "border: 1px solid; border-style: none solid none solid">\n                          <p style="margin: auto;\n                                    text-align: center;\n                                    padding: 20px 5px;\n                                    line-height: 21px;"> ${i} </p>\n                        </div>\n                        <div id = "aqi-forecast">\n                          <p style="margin: auto;\n                                    text-align: center;\n                                    padding: 20px 5px;\n                                    line-height: 21px;""> ${a} </ptrailer-0>\n                        </div>\n                      </div>\n    `:setTimeout((()=>document.querySelector("#temp-wind-aq").innerHTML=""),1e3)})(e),(e=>{e.renderWeather?T[1].innerHTML='<p class = "trailer-0 padding-trailer-0 sectionHeader">WEATHER</p>\n                                     <p class = "trailer-0 padding-leader-0 sectionSubHeader">AT LOCATION</p>':T[1].innerHTML=""})(e),ct({temp:e,wind:t})},ct=({temp:e,wind:t})=>{const r=document.querySelectorAll(".unit-conversion"),n=document.querySelector("#today-temp"),i=document.querySelector("#tomorrow-temp"),a=document.querySelector("#today-wind"),s=document.querySelector("#tomorrow-wind"),o=`<p style="margin: 1rem; text-align: center;">${e.todayF}</p>`,l=`<p style="margin: 1rem; text-align: center;">${e.todayC}</p>`,d=`<p style="margin: 1rem; text-align: center;">${e.tomorrowF}</p>`,c=`<p style="margin: 1rem; text-align: center;">${e.tomorrowC}</p>`,p=`<p style="margin: 1rem; text-align: center;"> ${t.today.mph} </p>`,m=`<p style="margin: 1rem; text-align: center;"> ${t.today.kph} </p>`,u=`<p style="margin: 1rem; text-align: center;"> ${t.tomorrow.mph} </p>`,y=`<p style="margin: 1rem; text-align: center;"> ${t.tomorrow.kph} </p>`;r.forEach((e=>{e.addEventListener("click",(e=>{!e.target.classList.contains("underline")&&(r.forEach((e=>{e.classList.remove("underline")})),e.target.classList.add("underline")),e.target.innerText.includes("F")?(n.innerHTML=o,i.innerHTML=d,a.innerHTML=p,s.innerHTML=u):(n.innerHTML=l,i.innerHTML=c,a.innerHTML=m,s.innerHTML=y)}))}))},pt=async({totalRadiusPopulation:e,perimeterPopulation:t})=>{const r=e?"WITHIN CIRCLE (2 MI RADIUS)":"WITHIN FIRE PERIMETER",n=(T[2].innerHTML=`<p class = "trailer-0 sectionHeader">POPULATION</p>\n                                                               <p class = "trailer-0 sectionSubHeader">${r}</p>`,e||t),i=({populationObject:e})=>{document.querySelector("#general-population").innerHTML=`\n      <div style = "margin-bottom: 10px;">\n      <h3 class= "bold">${e.totalPopulation}</h3>\n      <p style = "margin: -5px auto -5px"> POPULATION </p>\n      </div>\n    `};(()=>{if(!n.totalPopulation)return document.querySelector("#disability").innerHTML="",document.querySelector("#poverty").innerHTML="",i({populationObject:n});i({populationObject:n}),(({populationObject:e})=>{document.querySelector("#poverty").innerHTML=`\n    <div style = "margin-bottom: 10px;">\n    <h3 class = "bold text-center">${e.percentofPopulationWithDisability}</h3>\n    <p class= "text-center" style = "margin: -5px auto -5px; text-align: left;">POVERTY</p>\n    </div>\n    `})({populationObject:n}),(({populationObject:e})=>{document.querySelector("#disability").innerHTML=`\n    <div style = "margin-bottom: 10px;">\n    <h3 class = "bold text-center">${e.percentofPopulationInPoverty}</h3>\n    <p class= "text-center" style = "margin: -5px auto -5px; text-align: left;">DISABILITY</p>\n    </div>\n    `})({populationObject:n})})()},mt=({radiusHousingData:e,perimeterHousingData:t})=>{const r=e?"WITHIN CIRCLE (2 MI RADIUS)":"WITHIN FIRE PERIMETER",n=(T[3].innerHTML=`<p class = "trailer-0 sectionHeader">HOUSING</p>\n                                                              <p class = "trailer-0 sectionSubHeader">${r}</p>`,e||t);n.TotalHousingUnits&&n.MedianValue?(document.querySelector("#housing-container").style.display="grid",document.querySelector("#housing-container-stats").innerHTML=`\n      <div style = "margin-bottom: 10px">\n      <h4 class= "bold">${n.TotalHousingUnits}</h4>\n        <p style = "margin-bottom: -5px;">TOTAL HOUSING UNITS </p> \n      </div>\n      <div>\n      <h4 class = "bold" style = "line-height: 1.2;">${n.MedianValue}</h4>\n        <p style = "margin-bottom: -5px;"> MEDIAN HOUSING VALUE </p>\n      </div>\n    `):(document.querySelector("#housing-container-stats").innerHTML="",document.querySelector("#housing-container").style.display="none",T[3].innerHTML="")},ut=({aggregateEcoObj:e,perimeterEcology:t})=>{const r=e?"WITHIN CIRCLE (2 MI RADIUS)":"WITHIN FIRE PERIMETER",n='<h4 class = "bold">None present</h4>';(({ecoObject:e})=>{(({ecoObject:e})=>{e.Hex_Count?(S[4].style.display="initial",T[4].innerHTML=`<p class = "trailer-0 sectionHeader">ECOSYSTEM</p>\n                                                <p class = "trailer-0 sectionSubHeader">${r}</p>`):(S[4].style.display="none",T[4].innerHTML="")})({ecoObject:e}),(({ecoObject:e})=>{if(e.L3EcoReg)return document.querySelector("#ecoregion").innerHTML=`\n     <div>\n        <p class = "trailer-0">ECOREGION</p>\n        <div style = "margin-bottom: 15px;">\n          <h4 class = "bold" style = "margin-top: -7px; ">${e.L3EcoReg}</h4>\n        </div>\n      </div>`;document.querySelector("#ecoregion").innerHTML=""})({ecoObject:e}),(({ecoObject:e})=>{e.LandForm?document.querySelector("#landform").innerHTML=`\n        <div>\n            <p class = "trailer-0">LANDFORM TYPE</p>\n            <div style = "margin-bottom: 15px;">\n              <h4 class = "bold" style = "margin-top: -7px;">${e.LandForm}</h4>\n            </div>\n          </div>`:document.querySelector("#landform").innerHTML=""})({ecoObject:e}),(({ecoObject:e})=>{e.ForestTypeGroup?document.querySelector("#forestType").innerHTML=`\n        <div>\n          <p style = "margin-bottom: 2px;">PREDOMINANT FOREST TYPE GROUPS</p>\n          <div class = "ecoregionInformation">\n            <h4 class = "bold">${e.ForestTypeGroup.length>1?e.ForestTypeGroup[0].trim()+" and "+e.ForestTypeGroup[1].trim():e.ForestTypeGroup[0].trim()}</h4>\n          </div>\n        </div>`:document.querySelector("#forestType").innerHTML=""})({ecoObject:e}),(({ecoObject:e})=>{e.SumCarbon?document.querySelector("#carbon").innerHTML=`\n      <div  style="margin-top: 15px;>\n        <p style = "margin-bottom: 2px;">POTENTIAL CARBON LOSS</p>\n        <div class = "ecoregionInformation">\n          <div style = "position: relative;">            \n            <h4 class = "bold">${e.SumCarbon.toLocaleString()} tons</h4>\n            </div>\n          </div>\n      </div>\n      `:document.querySelector("#carbon").innerHTML=""})({ecoObject:e}),(({ecoObject:e})=>{e.RichClass?document.querySelector("#biodiversity").innerHTML=`\n          <div style = "margin-bottom: 1.5625rem;">\n            <div style = "width: 100%;">\n              <div>\n              <p class = "trailer-0">BIODIVERSITY</p>\n            </div>\n            <div style ="width: 100%; display: flex; text-align: center;">\n              <div style = "width: 50%; text-align: center; align-self: center;">\n              <h4 class = "bold">${e.RichClass}</h4>\n                  <p style ="margin-bottom: 5px; margin-top: 5px;">Imperiled Species Biodiversity</p>\n              </div>\n              <div style = "width: 70%;">\n              <div style = "width: 100%;">\n                <img src="https://www.arcgis.com/sharing/rest/content/items/668bf6e91edd49d1bb8b3f00d677b315/data"\n                  style="width:77px; height:77px;\n                  // margin-right: 10px; \n                  display: inline-flex;" \n                  viewbox="0 0 70 70" \n                  class="svg-icon" \n                  type="image/svg+xml">\n                <img src="https://www.arcgis.com/sharing/rest/content/items/bc5dc73ad7d345de840c128cc42cc938/data"\n                  style="width:77px; height:77px; \n                  display: inline-flex;" \n                  viewbox="0 0 70 70" \n                  class="svg-icon" \n                  type="image/svg+xml">\n                <img src="https://www.arcgis.com/sharing/rest/content/items/96a4af6a248b4da48f1b7bd703f88485/data"\n                  style="width:77px; height:77px;\n                  // margin-right: 7px;\n                  display: inline-flex;" \n                  viewbox="0 0 70 70" \n                  class="svg-icon" \n                  type="image/svg+xml">\n                <img src="https://www.arcgis.com/sharing/rest/content/items/3c9e63f9173a463ba4e5765c08cf7238/data"\n                  style="width:77px; height:77px; \n                  display: inline-flex;" \n                  viewbox="0 0 70 70" \n                  class="svg-icon" \n                  type="image/svg+xml">\n                </div> \n              </div>\n            </div>\n          </div>`:document.querySelector("#biodiversity").innerHTML=""})({ecoObject:e}),(({ecoObject:e})=>{e.CritHab?document.querySelector("#criticalHabitat").innerHTML=`\n      <div style = margin-top: 10px>\n        <p style = "margin-bottom: 2px;">CRITICAL HABITAT DESIGNATION</p>\n        <div class = "ecoregionInformation">\n          <h4 class = "bold">${e.CritHab}</h4>\n        </div>\n      </div>`:document.querySelector("#criticalHabitat").innerHTML=`\n      <div style = margin-top: 10px>\n        <p style = "margin-bottom: 2px;">CRITICAL HABITAT DESIGNATION</p>\n        <div class = "ecoregionInformation">\n          <h4 class = "bold">${n}</h4>\n        </div>\n      </div>`})({ecoObject:e}),(({ecoObject:e})=>{if(e.OwnersPadus){const t=`<h4 class = "bold">${e.OwnersPadus.join(", ")}</h4>`,r=`<p class = "bold">${e.OwnersPadus.join(", ")}</p>`;return document.querySelector("#protectedAreas").innerHTML=`\n      <div>\n        <p style = "margin-bottom: 2px;">PUBLIC LANDS & PROTECTED AREAS</p>\n        <div class = "ecoregionInformation">\n          <div>${e.OwnersPadus.length<4?t:r}</div>\n        </div>\n      </div>`}document.querySelector("#protectedAreas").innerHTML=`\n      <div>\n        <p style = "margin-bottom: 2px;">PROTECTED AREAS, TRIBAL LANDS, </br>& WILDERNESS AREAS</p>\n        <div class = "ecoregionInformation">\n          <div>${n}</div>\n        </div>\n      </div>`})({ecoObject:e})})({ecoObject:e||t})}}));